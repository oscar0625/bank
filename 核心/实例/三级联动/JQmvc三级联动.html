<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<select  id="brand">
    <option value="-1">请选择品牌</option>
</select>
<select id="model">
    <option value="-1">请选择车型</option>
</select>
<select id="car">
    <option value="-1">请选择车款</option>
</select>
</body>
<script src="../January4/js/jquery-1.7.2.min.js"></script>
<script src="../January4/js/make_json.js"></script>
<script src="../January4/js/model_json.js"></script>
<script src="../January4/js/car_json.js"></script>
<script>
    $(function () {
        var car_brand=$('#brand');
        var car_model=$('#model');
        var car_car=$('#car');
        var ctrl={
            init: function () {
                this.createBrand();
                this.brandChange();
                this.modelChange();
            },
            createBrand: function () {
                var data=model.getBrand();
                view.showBrand(data);
                this.createModel();
            },
            createModel: function () {
                var id=car_brand.val();
                if(id==-1){
                    car_model[0].length=1;
                    car_car[0].length=1;
                    return
                }
                var data=model.getModel(id);
                view.showModel(data);
                this.createCar();
            },
            createCar: function () {
                var id=car_model.val();
                if(id==-1){
                    car_car[0].length=1;
                    return
                }
                var data=model.getCar(id);
                view.showCar(data);
            },
            brandChange: function () {
                var self=this;
                car_brand.on('change', function () {
                    self.createModel();
                });
            },
            modelChange: function () {
                var self=this;
                car_model.on('change', function () {
                    self.createCar();
                })
            }
        };
        var model={
            getBrand: function () {
                return make_json
            },
            getModel: function (id) {
                return model_json[id]
            },
            getCar: function (id) {
                return car_json[id]
            }
        };
        var view={
            main: function (data,mb) {
                var str='';
                $.each(data,function () {
                    str+='<option value="'+this.id+'">'+this.name+'</option>';
                });
                mb[0].length=1;
                mb.append(str);
                mb.children().eq(1).attr('selected',true);
            },
            showBrand: function (data) {
                this.main(data,car_brand);
            },
            showModel: function (data) {
                this.main(data,car_model);
            },
            showCar: function (data) {
                this.main(data,car_car);
            }
        };
        ctrl.init()
    })
</script>
</html>