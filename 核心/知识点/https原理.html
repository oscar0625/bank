<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <title>HTTPS原理</title>
</head>

<body>


</body>
<script>
    //  一、HTTPS
    //      HTTPS是在HTTP上建立SSL加密层，并对传输数据进行加密，是HTTP协议的安全版。
    //  HTTP与HTTPS的区别
    //      1.HTTP是明文传输协议，HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输、身份认证的网络协议，比 HTTP 协议安全。
    //      2.HTTPS比HTTP更加安全，对搜索引擎更友好，利于SEO,谷歌、百度优先索引HTTPS网页;
    //      3.HTTPS需要用到SSL证书，而HTTP不用;
    //      4.HTTPS标准端口443，HTTP标准端口80;
    //      5.HTTPS基于传输层，HTTP基于应用层;
    //      6.HTTPS在浏览器显示绿色安全锁，HTTP没有显示;

    //  二、HTTP协议存在的哪些问题
    //      1.通信使用明文（不加密），内容可能被窃听
    //      2.无法证明报文的完整性，所以可能遭篡改
    //      3.不验证通信方的身份，因此有可能遭遇伪装

    //  三、HTTPS如何解决HTTP上述问题?
    //      1.数据隐私性：内容经过对称加密，每个连接生成一个唯一的加密密钥（非对称加密+对称加密）
    //      2.数据完整性：内容传输经过完整性校验（数字签名）
    //      3.身份认证：第三方无法伪造服务端（客户端）身份（数字证书）
    //  工作原理：
    //      所谓HTTPS，其实就是身披SSL协议这层外壳的HTTP。
    //      HTTPS 协议的主要功能基本都依赖于 TLS/SSL 协议，TLS/SSL 的功能实现主要依赖于三类基本算法：散列函数、对称加密和非对称加密
    //      利用非对称加密实现身份认证和密钥协商
    //      对称加密采用协商的密钥对数据进行加密解密
    //      基于散列函数验证信息的完整性
    //  工作流程：
    //      1.Client发起一个HTTPS（比如 https://juejin.im/user）的请求，根据RFC2818的规定，Client知道需要连接Server的443（默认）端口。
    //      2.Server把事先配置好的公钥证书（public key certificate）返回给客户端。
    //      3.Client验证公钥证书：比如是否在有效期内，证书的用途是不是匹配Client请求的站点，是不是在CRL吊销列表里面，它的上一级证书是否有效，这是一个递归的过程，直到验证到根证书（操作系统内置的Root证书或者Client内置的Root证书）。如果验证通过则继续，不通过则显示警告信息。
    //      4.Client使用伪随机数生成器生成加密所使用的对称密钥，然后用证书的公钥加密这个对称密钥，发给Server。
    //      5.Server使用自己的私钥（private key）解密这个消息，得到对称密钥。至此，Client和Server双方都持有了相同的对称密钥。
    //      6.Server使用对称密钥加密“明文内容A”，发送给Client。
    //      7.Client使用对称密钥解密响应的密文，得到“明文内容A”。
    //      8.Client再次发起HTTPS的请求，使用对称密钥加密请求的“明文内容B”，然后Server使用对称密钥解密密文，得到“明文内容B”。

    //  四、其他
    //  1.加密
    //      非对称加密
    //          公开密钥加密方式。使用一对非对称的密钥。一把叫做私有密钥，另一把叫做公开密钥。发送密文的一方使用对方的公开密钥进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。
    //      对称加密
    //          这种方式加密和解密同用一个密钥。加密和解密都会用到密钥。没有密钥就无法对密码解密，反过来说，任何人只要持有密钥就能解密了。
    //      非对称加密+对称加密
    //          在交换密钥环节使用非对称加密方式，之后的建立通信交换报文阶段则使用对称加密方式。
    //          具体做法是：发送密文的一方使用对方的公钥进行加密处理“对称密钥”，然后对方用自己的私钥解密拿到“对称密钥”，这样可以确保交换的密钥是安全的前提下，使用对称加密方式进行通信。所以，HTTPS采用对称加密和非对称加密两者并用的混合加密机制。

    //  2.数字证书和数字签名
    //  证书颁发机构（Certificate Authority，简称CA）数字证书认证机构处于客户端与服务器双方都可信赖的第三方机构的立场上。
    //  数字证书认证机构的业务流程：
    //  1.服务器的运营人员向第三方机构CA提交公钥、组织信息、个人信息(域名)等信息并申请认证;
    //  2.CA通过线上、线下等多种手段验证申请者提供信息的真实性，如组织是否存在、企业是否合法，是否拥有域名的所有权等;
    //  3.如信息审核通过，CA会向申请者签发认证文件-证书。证书包含以下信息：申请者公钥、申请者的组织信息和个人信息、签发机构 CA的信息、有效时间、证书序列号等信息的明文，同时包含一个签名。其中签名的产生算法：首先，使用散列函数计算公开的明文信息的信息摘要，然后，采用 CA的私钥对信息摘要进行加密，密文即签名;
    
    //  4.客户端 Client 向服务器 Server 发出请求时，Server 返回证书文件;
    //  5.客户端 Client 读取证书中的相关的明文信息，采用相同的散列函数计算得到信息摘要，然后，利用对应CA的公钥解密签名数据，对比证书的信息摘要，如果一致，则可以确认证书的合法性，即服务器的公开密钥是值得信赖的。
    //  6.客户端还会验证证书相关的域名信息、有效时间等信息; 客户端会内置信任CA的证书信息(包含公钥)，如果CA不被信任，则找不到对应 CA的证书，证书也会被判定非法。
</script>

</html>